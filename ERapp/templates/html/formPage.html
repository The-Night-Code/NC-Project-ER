{% load static %}
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->


        <form method="post">
            {% csrf_token %}
            <table>
                <thead>
                    <tr>
                        <th>Column Header</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in data %}
                    <tr>
                        <td>{{ item.cell_data }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {{ form.as_p }}
            <button type="submit">Add Row</button>
          </form>
        
        <script >
            
            $(document).ready(function() {
                $("#add-row").click(function() {
                    $("#data-table tbody").append("<tr><td><input type='text' name='cell_data'></td></tr>");
                });
            
                $("#add-col").click(function() {
                    $("#data-table thead").append("<th>Column Header</th>");
                    $("#data-table tbody tr").append("<td><input type='text' name='cell_data'></td>");
                });
            });
  
        </script>





        <form method="post">
            {% csrf_token %}
            <table>
                <thead>
                    <tr>
                        {% for header in headers %}
                        <th>{{ header }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for row in data %}
                    <tr>
                        {% for cell in row %}
                        <td>{{ cell }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {{ form.as_p }}
            <button type="submit">Add Row</button>
            <button type="button" id="add-column">Add Column</button>
            <button type="button" id="save-table">Save</button>
        </form>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>
            $(document).ready(function() {
                $("#add-column").click(function() {
                    var columnName = prompt("Enter column name:");
                    if (columnName) {
                        // Add the new column header to the table
                        $("thead tr").append("<th>" + columnName + "</th>");
                        
                        // Add an empty cell for the new column in each row
                        $("tbody tr").each(function() {
                            $(this).append("<td><input type='text' name='cell_data'></td>");
                        });
                    }
                    
                });
                $("#save-table").click(function() {
                  // Create an array to store cell_data values
                  var cellDataValues = [];
          
                  // Iterate over each input field and add its value to the array
                  $("input[name='cell_data']").each(function() {
                      cellDataValues.push($(this).val());
                  });
          
                  // Send an AJAX request to save the table data
                  $.ajax({
                      type: "POST",
                      url: "{% url 'save_table' %}",
                      data: {
                          csrfmiddlewaretoken: "{{ csrf_token }}",
                          cell_data: cellDataValues,
                      },
                      success: function() {
                          // Optionally, you can provide feedback to the user upon successful save
                          alert("Table data saved successfully.");
                      },
                      error: function() {
                          alert("Error occurred while saving table data.");
                      }
                  });
              });
          });
        </script>




        
    </body>
</html>